No One Tweets Like the Japanese, and That Was a Huge Problem for Twitter No One Tweets Like the Japanese, and That Was a Huge Problem for Twitter 
Twitter engineer Mazdak Hashemi says the Japanese tweet like no one else on earth.
When the New Year arrives or even as they watch certain moments in shows and movies broadcast on national television, tens of thousands of Japanese will tweet at practically the same instant. &ldquo;Everyone tweets at the New Year, but the Japanese are more in-sync,&rdquo; says Hashemi, who, as Twitter&rsquo;s director of site reliability engineering, works to make sure its mini-messaging service stays in good working order. &ldquo;They do it at exactly midnight.&rdquo;
This provides a small window into the unique culture of the Japanese, known for exhibiting a certain type of conformity, but there was a time when it was also an enormous problem for Twitter. As the year 2012 arrived in Japan, the country&rsquo;s synchronized tweets crashed the entire site, worldwide. It was 3pm in Britain when the site went belly-up.
&lsquo;Everyone tweets at the New Year, but the Japanese are more in-sync. They do it at exactly midnight.&rsquo;
So, as the next New Year approached, Raffi Krikorian, one of Twitter&rsquo;s lead engineers, urged Hashemi to find a better way of ensuring the site could handle the next wave of synchronized Japanese tweets. &ldquo;I think he had some post-traumatic stress,&rdquo; Hashemi says of Krikorian in the wake of the 2012 New Year. As a result, Hashemi and his team built a new system&mdash;known as a software &ldquo;framework,&rdquo; in engineering speak&mdash;that would let them mimic events like a Japanese New Year tweet storm and actually run these synthetic creations on the thousands of computers that run the live the site.
Internet engineers call it &ldquo;stress testing,&rdquo; and though this sort of thing is very common, Twitter&rsquo;s situation was a bit different, and its methods could serve as a model for other online operations as they reach Twitter-like sizes. Because of the real-time nature of the site&mdash;where people expect to send and receive instantly, at all times&mdash;Hashemi and his team needed tools that could very carefully shape and reshape these massive tests, and because the service is used in this real-time way across the globe&mdash;it spans 240 million users who generate about about 5,700 tweets a second&mdash;there weren&rsquo;t &ldquo;off hours&rdquo; when they could run live tests without having to worry about massive amounts of &ldquo;real&rdquo; traffic.
&ldquo;We can&rsquo;t test outside of business hours,&rdquo; says Ali Alzabarah, who works alongside Hashemi. &ldquo;We don&rsquo;t have business hours.&rdquo;
The tests Hashemi wanted to run were so large&mdash;larger than the real traffic storm that brought down the site during the last New Year&mdash;some engineers at Twitter didn&rsquo;t even want him to try them. &ldquo;They thought I was smoking something,&rdquo; says Hashemi, who describes the company&rsquo;s wider testing efforts in a blog post published today. &ldquo;You&rsquo;re pretty much putting your job on the line. It&rsquo;s like: &lsquo;Am I going to be here or not?&rsquo;&rdquo;
But the stress testing framework he and his team built also included new monitoring tools that would let closely track the results of the tests&mdash;on a second-by-second basis&mdash;and scale them back as need be. In the end, these tests proved very successful&mdash;and the site stayed up for the next New Year, and the one after that. Last August, it also held firm when the Japanese helped set a new tweets-per-second record as they all tweeted at the arrival of a particular moment in the television airing of an animated movie called Castle in the Sky.
Much of this is thanks to an sweeping effort to rebuild the site using a software programming technology called Scala. And the company may be expanding into data centers in other parts of the world, so that it serve foreign countries like Japan with dedicated local machines&mdash;though Hashemi declines to comment on this. But the company&rsquo;s new stress testing framework plays its own important role. According to Adrian Cockcroft, a technology fellow with venture capital firm Battery Ventures who previously served as a chief architect at Netflix, another company that deals with rather usual types and amounts of online traffic, this sort of thing isn&rsquo;t easy.
&lsquo;We can&rsquo;t test outside of business hours. We don&rsquo;t have business hours.&rsquo;
&ldquo;As soon as you get to enormous scale, the off-the-shelf testing products fail,&rdquo; he says. &ldquo;You have to synthesize so much traffic with a pattern that actually matters. You have to put a lot of thought into what the traffic pattern is, and it&rsquo;s quite hard, then, to actually build it. There are certain subtleties to this.&rdquo;
As other services across the net continue to grow, they too will face similar testing problems, and the good news is that companies like Netflix and Twitter are showing the way. Netflix has opened sourced many of the tools it has built to test its site, and Twitter is a company that works in similar ways, sharing many of its software creations with the world at large in an effort boost the larger community of sites and services. 
Twitter has already open sourced a tool called Iago that generates the &ldquo;fake traffic&rdquo; for its stress tests, and though it has not released its stressing testing framework for carefully building and monitoring these tests&mdash;the thing doesn&rsquo;t even have a name&mdash;the company could do so in the future. That could come in handy. After all, the Japanese aren&rsquo;t going anywhere. Nor is the rest of the net.